{"sha":"44fd7d34b9b688ed28b415b573b0ef1fc8c2d5e1c039f499bede9ed44e90ab61","key":{"template":{"id":"generate-python-tests","title":"Generate python tests"},"fragment":{"fullId":"email_recognizer.py.gpspec.md:0:0","hash":"1f2e6fc915fb612f"}},"val":{"response":{"edits":[{"label":"Create /workspaces/coarch/packages/helloworld/test_email_recognizer.py","filename":"/workspaces/coarch/packages/helloworld/test_email_recognizer.py","type":"createfile","text":"import unittest\nfrom email_recognizer import is_valid_email\n\nclass TestEmailRecognizer(unittest.TestCase):\n\n    def test_valid_email(self):\n        self.assertTrue(is_valid_email(\"john.doe@example.com\"))\n\n    def test_invalid_email_no_at(self):\n        self.assertFalse(is_valid_email(\"johndoeexample.com\"))\n\n    def test_invalid_email_no_domain(self):\n        self.assertFalse(is_valid_email(\"john.doe@\"))\n\n    def test_invalid_email_special_chars(self):\n        self.assertFalse(is_valid_email(\"john.doe@exa$mple.com\"))\n\n    def test_invalid_email_no_username(self):\n        self.assertFalse(is_valid_email(\"@example.com\"))\n\nif __name__ == '__main__':\n    unittest.main()\n","overwrite":true},{"label":"Create /workspaces/coarch/packages/helloworld/email_recognizer.py.gpspec.md","filename":"/workspaces/coarch/packages/helloworld/email_recognizer.py.gpspec.md","type":"createfile","text":"# email_recognizer.py\n\n-   [email_recognizer.py](./email_recognizer.py)\n","overwrite":true},{"label":"Generate python tests","filename":"/workspaces/coarch/packages/helloworld/email_recognizer.py.gpspec.md","type":"insert","pos":[2,48],"text":"\n-   [test_email_recognizer.py](test_email_recognizer.py)"}],"fileEdits":{"/workspaces/coarch/packages/helloworld/test_email_recognizer.py":{"before":null,"after":"import unittest\nfrom email_recognizer import is_valid_email\n\nclass TestEmailRecognizer(unittest.TestCase):\n\n    def test_valid_email(self):\n        self.assertTrue(is_valid_email(\"john.doe@example.com\"))\n\n    def test_invalid_email_no_at(self):\n        self.assertFalse(is_valid_email(\"johndoeexample.com\"))\n\n    def test_invalid_email_no_domain(self):\n        self.assertFalse(is_valid_email(\"john.doe@\"))\n\n    def test_invalid_email_special_chars(self):\n        self.assertFalse(is_valid_email(\"john.doe@exa$mple.com\"))\n\n    def test_invalid_email_no_username(self):\n        self.assertFalse(is_valid_email(\"@example.com\"))\n\nif __name__ == '__main__':\n    unittest.main()\n"}},"trace":"\n# Prompt trace\n\n\n\n## Prompt template \"Generate python tests\" (`generate-python-tests`)\n\n```````````````js\n  1: gptool({\n  2:     title: \"Generate python tests\",\n  3:     model: \"gpt-4\",\n  4:     description: \"Given a task and code, generate tests\",\n  5:     categories: [\"hello world\"],\n  6:     system: [\"system\", \"system.explanations\", \"system.summary\", \"system.files\", \"system.python\"],\n  7:     temperature: 0\n  8: })\n  9: \n 10: def(\"TESTS\", env.links.filter((f) => /^test_*\\.py$/.test(f.filename)))\n 11: def(\"TASK\", env.file)\n 12: def(\n 13:     \"CODE\",\n 14:     env.links.filter(\n 15:         (f) => f.filename.endsWith(\".py\") && !f.filename.startsWith(\"test_\")\n 16:     )\n 17: )\n 18: \n 19: $`Python has been written for the task in TASK. The code is in CODE.\n 20: Generate 5 tests for the code in CODE in a separate file.\n 21: Do not modify or duplicate the code in CODE.\n 22: \n 23: If the tests are already present in TESTS, ensure that the tests\n 24: match the description in TASK and the code in CODE.  If they do not,\n 25: update the tests to match the code and the description.\n 26: \n 27: Use this format for test file names: \"test_*.py\".\n 28:  \n 29: Include the unittest test harness that can run the tests from the command line.`\n 30: \n```````````````\n\n\n\n## Inline prompts\n\nAdded as comment at the end of a fragment: \n\n```markdown\nLorem ipsum...\n\n<!-- @prompt.NAME \nYou are concise.\n!-->\n```\n        \n\n-   **@prompt** missing\n-   **@prompt.hello world** missing\n\n\n## console output\n> tip: use `console.log()` from gptool.js files\n## Expanded prompt\n\n```````````````markdown\nTASK:\n````` file=email_recognizer.py.gpspec.md\n# email_recognizer.py\n\n-   [email_recognizer.py](./email_recognizer.py)\n`````\n\nCODE:\n````` file=email_recognizer.py\nimport re\n\ndef is_valid_email(email: str) -> bool:\n    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$'\n    return bool(re.match(pattern, email))\n`````\n\nPython has been written for the task in TASK. The code is in CODE.\nGenerate 5 tests for the code in CODE in a separate file.\nDo not modify or duplicate the code in CODE.\n\nIf the tests are already present in TESTS, ensure that the tests\nmatch the description in TASK and the code in CODE.  If they do not,\nupdate the tests to match the code and the description.\n\nUse this format for test file names: \"test_*.py\".\n \nInclude the unittest test harness that can run the tests from the command line.\n```````````````\n\n\n## Variables\nVariables are referenced through `env.NAME` in prompts.\n\n-   env.**error**: `ERROR-UGHGBQ`\n\n-   env.**file**\n```````````````js\n{ filename: \"email_recognizer.py.gpspec.md\",\nlabel: \"current\",\ncontent: \"# email_recognizer.py\\n\\n-   [email_recognizer.py](./email_rec\"... }\n```````````````\n\n-   env.**links**\n```````````````js\n[ { label: \"email_recognizer.py\",\n  filename: \"email_recognizer.py\",\n  content: \"import re\\n\\ndef is_valid_email(email: str) -> bool:\\n    patte\"... } ]\n```````````````\n\n-   env.**parents**\n```````````````js\n[  ]\n```````````````\n\n-   env.**fence**\n```````````````\n`````\n```````````````\n\n-   env.**promptOptions**\n```````````````js\n{  }\n```````````````\n\n-   env.**vars**\n```````````````js\n{  }\n```````````````\n\n-   env.**templates**\n```````````````js\n[ { id: \"generate-python\",\n  title: \"Generate python code\",\n  description: \"Given a task, generate python code.\" },\n{ id: \"generate-python-tests\",\n  title: \"Generate python tests\",\n  description: \"Given a task and code, generate tests\" },\n{ id: \"core.default\",\n  title: \"Run gpspec directly\",\n  description: \"This is the default gptool that assumes the gpspec contains \"... } ]\n```````````````\n\n-   env.**template**\n```````````````js\n{ id: \"generate-python-tests\",\ntitle: \"Generate python tests\",\ntext: \"<nothing yet>\",\njsSource: \"gptool({\\n    title: \\\"Generate python tests\\\",\\n    model: \\\"gpt\"...,\nfilename: \"/workspaces/coarch/packages/helloworld/gptools/generate-pyth\"...,\nmodel: \"gpt-4\",\ndescription: \"Given a task and code, generate tests\",\ncategories: [ \"hello world\" ],\nsystem: [ \"system\",\n  \"system.explanations\",\n  \"system.summary\",\n  \"system.files\",\n  \"system.python\" ],\ntemperature: 0,\ninput: \".md\" }\n```````````````\n\n## System prompt\n###  template: `system`\n\n```````````````js\n  1: system({ title: \"System prompt\" })\n  2: $`You are concise. Answer in markdown.`\n```````````````\n#### Expanded system prompt\n```````````````markdown\nYou are concise. Answer in markdown.\n```````````````\n###  template: `system.explanations`\n\n```````````````js\n  1: system({ title: \"Explain your answers\" })\n  2: $`When explaining answers, take a deep breath.`\n  3: \n```````````````\n#### Expanded system prompt\n```````````````markdown\nWhen explaining answers, take a deep breath.\n```````````````\n###  template: `system.summary`\n\n```````````````js\n  1: system({\n  2:     title: \"Summarize\",\n  3:     description: \"Generate a summary of the changes\",\n  4: })\n  5: \n  6: $`Additionally, generate a concise SUMMARY of the changes in all files using the following syntax:`\n  7: \n  8: def(`SUMMARY`, `This is a summary of the changes in files.`)\n  9: \n```````````````\n#### Expanded system prompt\n```````````````markdown\nAdditionally, generate a concise SUMMARY of the changes in all files using the following syntax:\n\nSUMMARY:\n`````\nThis is a summary of the changes in files.\n`````\n```````````````\n###  template: `system.files`\n\n```````````````js\n  1: system({ title: \"File generation\", description: \"Teaches the file format supported by CoArch\" })\n  2: \n  3: const folder =\n  4:     env.vars[\"system.multifile.outputFolder\"] ||\n  5:     env.template.outputFolder\n  6: $`When generating or updating files you will use the following syntax:`\n  7: \n  8: def(`File ${folder || \".\"}/file1.ts`, `What goes in\\n${folder || \".\"}/file1.ts.`)\n  9: def(`File /path_to_file/file2.md`, `What goes in\\n/path_to_file/file2.md.`)\n 10: \n 11: $`Make sure to use precisely ${env.fence} to guard file code sections.`\n 12: $`Use full path of filename in code section header.`\n 13: if (folder)\n 14:     $`When generating new files, place files in folder \"${folder}\".`\n 15: $`If a file does not have changes, do not regenerate.`\n 16: \n```````````````\n#### Expanded system prompt\n```````````````markdown\nWhen generating or updating files you will use the following syntax:\n\nFile ./file1.ts:\n`````\nWhat goes in\n./file1.ts.\n`````\n\nFile /path_to_file/file2.md:\n`````\nWhat goes in\n/path_to_file/file2.md.\n`````\n\nMake sure to use precisely ````` to guard file code sections.\n\nUse full path of filename in code section header.\n\nIf a file does not have changes, do not regenerate.\n```````````````\n###  template: `system.python`\n\n```````````````js\n  1: system({\n  2:     title: \"Python Developer\",\n  3:     description: \"Expert at generating and understanding Python code.\"\n  4: })\n  5: \n  6: $`Also, you are an expert coder in Python. You create code that is PEP8 compliant.`\n  7: \n```````````````\n#### Expanded system prompt\n```````````````markdown\nAlso, you are an expert coder in Python. You create code that is PEP8 compliant.\n```````````````\n\n\n## Final prompt\n\n-  model: `gpt-4`\n-  temperature: \n-  max tokens: 800\n\n```````````````markdown\nTASK:\n````` file=email_recognizer.py.gpspec.md\n# email_recognizer.py\n\n-   [email_recognizer.py](./email_recognizer.py)\n`````\n\nCODE:\n````` file=email_recognizer.py\nimport re\n\ndef is_valid_email(email: str) -> bool:\n    pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$'\n    return bool(re.match(pattern, email))\n`````\n\nPython has been written for the task in TASK. The code is in CODE.\nGenerate 5 tests for the code in CODE in a separate file.\nDo not modify or duplicate the code in CODE.\n\nIf the tests are already present in TESTS, ensure that the tests\nmatch the description in TASK and the code in CODE.  If they do not,\nupdate the tests to match the code and the description.\n\nUse this format for test file names: \"test_*.py\".\n \nInclude the unittest test harness that can run the tests from the command line.\n```````````````\n\n\n## AI Output\n\n\n```````````````markdown\nFile ./test_email_recognizer.py:\n`````\nimport unittest\nfrom email_recognizer import is_valid_email\n\nclass TestEmailRecognizer(unittest.TestCase):\n\n    def test_valid_email(self):\n        self.assertTrue(is_valid_email(\"john.doe@example.com\"))\n\n    def test_invalid_email_no_at(self):\n        self.assertFalse(is_valid_email(\"johndoeexample.com\"))\n\n    def test_invalid_email_no_domain(self):\n        self.assertFalse(is_valid_email(\"john.doe@\"))\n\n    def test_invalid_email_special_chars(self):\n        self.assertFalse(is_valid_email(\"john.doe@exa$mple.com\"))\n\n    def test_invalid_email_no_username(self):\n        self.assertFalse(is_valid_email(\"@example.com\"))\n\nif __name__ == '__main__':\n    unittest.main()\n`````\n\nSUMMARY:\n`````\nCreated a test file (test_email_recognizer.py) with 5 tests for the is_valid_email function in email_recognizer.py.\n`````\n```````````````\n\n\n### Extracted Variables\n\n-   `File ./test_email_recognizer.py`\n`````py\nimport unittest\nfrom email_recognizer import is_valid_email\n\nclass TestEmailRecognizer(unittest.TestCase):\n\n    def test_valid_email(self):\n        self.assertTrue(is_valid_email(\"john.doe@example.com\"))\n\n    def test_invalid_email_no_at(self):\n        self.assertFalse(is_valid_email(\"johndoeexample.com\"))\n\n    def test_invalid_email_no_domain(self):\n        self.assertFalse(is_valid_email(\"john.doe@\"))\n\n    def test_invalid_email_special_chars(self):\n        self.assertFalse(is_valid_email(\"john.doe@exa$mple.com\"))\n\n    def test_invalid_email_no_username(self):\n        self.assertFalse(is_valid_email(\"@example.com\"))\n\nif __name__ == '__main__':\n    unittest.main()\n\n`````\n\n-   `SUMMARY`\n`````\nCreated a test file (test_email_recognizer.py) with 5 tests for the is_valid_email function in email_recognizer.py.\n\n`````\n\n","text":"File ./test_email_recognizer.py:\n`````\nimport unittest\nfrom email_recognizer import is_valid_email\n\nclass TestEmailRecognizer(unittest.TestCase):\n\n    def test_valid_email(self):\n        self.assertTrue(is_valid_email(\"john.doe@example.com\"))\n\n    def test_invalid_email_no_at(self):\n        self.assertFalse(is_valid_email(\"johndoeexample.com\"))\n\n    def test_invalid_email_no_domain(self):\n        self.assertFalse(is_valid_email(\"john.doe@\"))\n\n    def test_invalid_email_special_chars(self):\n        self.assertFalse(is_valid_email(\"john.doe@exa$mple.com\"))\n\n    def test_invalid_email_no_username(self):\n        self.assertFalse(is_valid_email(\"@example.com\"))\n\nif __name__ == '__main__':\n    unittest.main()\n`````\n\nSUMMARY:\n`````\nCreated a test file (test_email_recognizer.py) with 5 tests for the is_valid_email function in email_recognizer.py.\n`````","summary":"Created a test file (test_email_recognizer.py) with 5 tests for the is_valid_email function in email_recognizer.py.\n"}}}
