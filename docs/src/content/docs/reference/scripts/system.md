---
title: System Prompts
sidebar:
    order: 10
---
<!-- autogenerated - node bundleprompts.mjs -->

System prompts are scripts that are executed and injected before the main prompt output.

-   `system.*.genai.js` are considered system prompt templates
-   system prompts are unlisted by default
-   system prompts must use the `system` function instead of `script`
-   system prompts are executed with the same environment as the main prompt

```js title="system.zscot.genai.js" "system"
system({
    title: "Zero-shot Chain of Thought",
})
$`Let's think step by step.`
```


## Custom system prompts list

The `system` field can be populated with an array of system prompt identifiers.

```js "system"
script({
    ...,
    system: ["system.annotations"]
})
```

## Builtin System Prompts

GenAIScript comes with a number of system prompt that support features like creating files, extracting diffs or
generating annotations. If unspecified, GenAIScript looks for specific keywords to activate the various system prompts.

### `system`

Markdown system prompt



`````js wrap
system({ title: "Markdown system prompt" })
$`You are concise. Answer in markdown.`
`````


### `system.annotations`

Emits annotations compatible with GitHub Actions

GitHub Actions workflows support annotations ([Read more...](https://docs.github.com/en/actions/using-workflows/workflow-commands-for-github-actions#setting-an-error-message)).

`````js wrap
system({
    title: "Emits annotations compatible with GitHub Actions",
    description:
        "GitHub Actions workflows support annotations ([Read more...](https://docs.github.com/en/actions/using-workflows/workflow-commands-for-github-actions#setting-an-error-message)).",
    lineNumbers: true,
})

$`Use the following format to create **file annotations** (same as GitHub Actions workflow).

::(notice|warning|error) file=<filename>,line=<start line>,endLine=<end line>::<message>

For example, an warning in main.py on line 3 with message "typo" would be:

::warning file=main.py,line=3,endLine=3::typo

For example, an error in app.js between line 1 and 4 with message "Missing semicolon" and a warning in index.ts on line 10, would be:

::error file=app.js,line=1,endLine=4::Missing semicolon
::warning file=index.ts,line=10,endLine=10::identation

Do NOT indent or place annontation in a code fence.
`

`````


### `system.changelog`

Generate changelog formatter edits



`````js wrap
system({
    title: "Generate changelog formatter edits",
    lineNumbers: true
})


$`For partial updates of files, return one or more ChangeLogs (CLs) formatted as follows. Each CL must contain
one or more code snippet changes for a single file. There can be multiple CLs for a single file.
Each CL must start with a description of its changes. The CL must then list one or more pairs of
(OriginalCode, ChangedCode) code snippets. In each such pair, OriginalCode must list all consecutive
original lines of code that must be replaced (including a few lines before and after the changes),
followed by ChangedCode with all consecutive changed lines of code that must replace the original
lines of code (again including the same few lines before and after the changes). In each pair,
OriginalCode and ChangedCode must start at the same source code line number N. Each listed code line,
in both the OriginalCode and ChangedCode snippets, must be prefixed with [N] that matches the line
index N in the above snippets, and then be prefixed with exactly the same whitespace indentation as
the original snippets above. See also the following examples of the expected response format.

CHANGELOG:
\`\`\`
ChangeLog:1@<file>
Description: <summary>.
OriginalCode@4-6:
[4] <white space> <original code line>
[5] <white space> <original code line>
[6] <white space> <original code line>
ChangedCode@4-6:
[4] <white space> <changed code line>
[5] <white space> <changed code line>
[6] <white space> <changed code line>
OriginalCode@9-10:
[9] <white space> <original code line>
[10] <white space> <original code line>
ChangedCode@9-9:
[9] <white space> <changed code line>
...
ChangeLog:K@<file>
Description: <summary>.
OriginalCode@15-16:
[15] <white space> <original code line>
[16] <white space> <original code line>
ChangedCode@15-17:
[15] <white space> <changed code line>
[16] <white space> <changed code line>
[17] <white space> <changed code line>
OriginalCode@23-23:
[23] <white space> <original code line>
ChangedCode@23-23:
[23] <white space> <changed code line>
\`\`\`
`
`````


### `system.diff`

Generates concise file diffs.



`````js wrap
system({
    title: "Generates concise file diffs.",
    lineNumbers: true,
})

$`The DIFF format should be used to generate diff changes on files: 
- added lines MUST start with +
- deleted lines MUST start with -
- deleted lines MUST exist in the original file (do not invent deleted lines)
- added lines MUST not exist in the original file

- preserve indentation
- use relative file path name
- emit original line numbers from existing lines and deleted lines
- only generate diff for files that have changes
- only emit a couple unmodified lines before and after the changes
- keep the diffs AS SMALL AS POSSIBLE


- do NOT generate diff for files that have no changes
- do NOT emit diff if lines are the same
- do NOT emit the whole file content
- do NOT emit line numbers for added lines

DIFF ./file.ts:
\`\`\`diff
[original line number]  <2 lines before changes (not the whole file)>
- [original line number] <deleted line>
- [original line number] <delete line 2>
+ <added line>
+ <added line 2>
[original line number]   <2 lines after changes (not the whole file)>
\`\`\`

DIFF ./file2.ts:
\`\`\`diff
[original line number]   <2 lines before changes (not the whole file)>
- [original line number] <deleted line>
- [original line number] <delete line 2>
+ <added line>
+ <added line 2>
[original line number]   <2 lines after changes (not the whole file)>
\`\`\`
`

$`Do not generate anything else than DIFF sections. Use one DIFF section per change.`

`````


### `system.explanations`

Explain your answers



`````js wrap
system({ title: "Explain your answers" })
$`When explaining answers, take a deep breath.`

`````


### `system.files`

File generation

Teaches the file format supported by GenAIScripts

`````js wrap
system({
    title: "File generation",
    description: "Teaches the file format supported by GenAIScripts",
})

const folder =
    env.vars["outputFolder"] || "."
$`## Files

When generating or updating files you will use the following syntax:`

def(
    `File ${folder}/file1.ts`,
    `What goes in\n${folder}/file1.ts.`,
    { language: "typescript" }
)
def(
    `File ${folder}/file1.py`,
    `What goes in\n${folder}/file1.py.`,
    { language: "python" }
)
def(
    `File /path_to_file/file2.md`,
    `What goes in\n/path_to_file/file2.md.`,
    { language: "markdown" }
)

$`Make sure to use precisely \`\`\` to guard file code sections.`
$`Make sure to use precisely \`\`\`\`\` to guard file markdown sections.`
$`Use full path of filename in code section header.`
if (folder !== ".") $`When generating new files, place files in folder "${folder}".`
$`If a file does not have changes, do not regenerate.`
$`Do NOT emit line numbers in file.`
$`CSV files are inlined as markdown tables.`

`````


### `system.files_schema`



Apply JSON schemas to generated data.

`````js wrap
system({
    description: "Apply JSON schemas to generated data.",
})

const folder = env.vars["outputFolder"] || "."

$`
## Files with Schema

When you generate JSON or YAML or CSV according to a named schema, 
you MUST add the schema identifier in the code fence header.
`

def(`File ${folder}/data.json`, `...`, {
    language: "json",
    schema: "CITY_SCHEMA",
})

`````


### `system.fs_find_files`

File Find Files

Functions to list files.

`````js wrap
system({
    title: "File Find Files",
    description: "Functions to list files.",
})

defFunction(
    "fs_find_files",
    "Finds file matching a glob pattern.",
    {
        type: "object",
        properties: {
            glob: {
                type: "string",
                description: "Search path in glob format, including the relative path from the project root folder.",
            }
        },
        required: ["glob"],
    },
    async (args) => {
        const { glob } = args
        const res = await workspace.findFiles(glob)
        return res.join("\n")
    }
)

`````


### `system.fs_read_file`

File Read File

Function to read file content as text.

`````js wrap
system({
    title: "File Read File",
    description: "Function to read file content as text.",
})

defFunction(
    "fs_read_file",
    "Reads a file as text from the file system.",
    {
        type: "object",
        properties: {
            filename: {
                type: "string",
                description:
                    "Path of the file to load, relative to the workspace.",
            },
            linestart: {
                type: "integer",
                description: "Line number (1-based) to start reading from.",
            },
            lineend: {
                type: "integer",
                description: "Line number (1-based) to end reading at.",
            },
        },
        required: ["filename"],
    },
    async (args) => {
        let { filename, linestart, lineend } = args
        if (!filename) return ""
        linestart = parseInt(linestart) - 1
        lineend = parseInt(lineend)
        let { content } = await workspace.readText(filename)
        if (!isNaN(linestart) && !isNaN(lineend)) {
            const lines = content.split("\n")
            content = lines.slice(linestart, lineend).join("\n")
        }
        return content
    }
)

`````


### `system.fs_read_summary`

File Read Summary

Function to summarize the content of a file.

`````js wrap
system({
    title: "File Read Summary",
    description: "Function to summarize the content of a file.",
})

defFunction(
    "fs_read_summary",
    "Reads a summary of a file from the file system.",
    {
        type: "object",
        properties: {
            filename: {
                type: "string",
                description:
                    "Path of the file to load, relative to the workspace.",
            },
        },
        required: ["filename"],
    },
    async (args) => {
        const { filename } = args
        if (!filename) return ""
        const { content } = await workspace.readText(filename)
        const summary = await runPrompt(_ => {
            const f = _.def("FILE", { filename, content, label: filename }, { maxTokens: 12000 })
            _.$`Summarize the content of ${f}. Keep it brief: generate a single sentence title and one paragraph description.`
        }, {
            model: "gpt-3.5-turbo",
            cache: true,
            cacheName: "fs_read_summary"
        })
        return summary.text
    }
)

`````


### `system.functions`

use functions



`````js wrap
system({
    title: "use functions"
})

$`Use tools if possible.`
`````


### `system.json`

JSON system prompt



`````js wrap
system({ title: "JSON system prompt", responseType: "json_object" })
$`Answer in JSON format.`
`````


### `system.python`



Expert at generating and understanding Python code.

`````js wrap
system({
    description: "Expert at generating and understanding Python code.",
})

$`Also, you are an expert coder in Python. 
You create code that is PEP8 compliant. 
Emit type information compatible with PyLance.`

`````


### `system.schema`

JSON Schema support



`````js wrap
system({
    title: "JSON Schema support",
})

$`## TypeScript Schema

A TypeScript Schema is a TypeScript type that defines the structure of a JSON object. 
The Type is used to validate JSON objects and to generate JSON objects.
It is stored in a \`typescript-schema\` code section.
JSON schemas can also be applied to YAML or TOML files.

    <schema-identifier>:
    \`\`\`typescript-schema
    type schema-identifier = ...
    \`\`\`
`

$`## JSON Schema

A JSON schema is a named JSON object that defines the structure of a JSON object. 
The schema is used to validate JSON objects and to generate JSON objects. 
It is stored in a \`json-schema\` code section.
JSON schemas can also be applied to YAML or TOML files.

    <schema-identifier>:
    \`\`\`json-schema
    ...
    \`\`\`

`
`````


### `system.summary`



Adds a summary of the changes

`````js wrap
system({
    description: "Adds a summary of the changes",
})

$`Additionally, generate a concise SUMMARY of the changes in all files using the following syntax:`

def(`SUMMARY`, `This is a summary of the changes in files.`)

`````


### `system.tasks`

Generates tasks



`````js wrap
system({ title: "Generates tasks" })

$`
You are an AI assistant that helps people create applications by splitting tasks into subtasks.
You are concise. Answer in markdown, do not generate code blocks. Do not number tasks.
`

`````


### `system.technical`

Technical Writer



`````js wrap
system({ title: "Technical Writer" });

$`Also, you are an expert technical document writer.`;

`````


### `system.typescript`

Export TypeScript Developer



`````js wrap
system({
    title: "Export TypeScript Developer",
})

$`Also, you are an expert coder in TypeScript.`

`````


### `system.web_search`

Web Search

Function to do a web search.

`````js wrap
system({
    title: "Web Search",
    description: "Function to do a web search.",
})

defFunction(
    "web_search",
    "Search the web for a user query using Bing Search.",
    {
        type: "object",
        properties: {
            q: {
                type: "string",
                description: "Search query.",
            },
        },
        required: ["q"],
    },
    async (args) => {
        const { q } = args
        const { webPages } = await retrieval.webSearch(q)
        return YAML.stringify(
            webPages.map((f) => ({
                url: f.filename,
                name: f.label,
                snippet: f.content,
            }))
        )
    }
)

`````


### `system.zero_shot_cot`



Zero-shot Chain Of Though technique. More at https://learnprompting.org/docs/intermediate/zero_shot_cot.

`````js wrap
system({
    description:
        "Zero-shot Chain Of Though technique. More at https://learnprompting.org/docs/intermediate/zero_shot_cot.",
})
$`Let's think step by step.`

`````

